<?xml version="1.0" encoding="UTF-8"?>
<FindBugsFilter>
    <!--
        Exclude EI_EXPOSE_REP* warnings for Lombok-generated code.
        Spring beans are immutable by contract after dependency injection,
        and defensive copying would be unnecessary overhead.
    -->
    <Match>
        <Bug pattern="EI_EXPOSE_REP,EI_EXPOSE_REP2" />
        <Class name="~me\.golemcore\.bot\..*" />
    </Match>

    <!-- But keep EI_EXPOSE_REP for public API models that users interact with -->
    <Match>
        <Bug pattern="EI_EXPOSE_REP,EI_EXPOSE_REP2" />
        <Not>
            <Or>
                <Class name="~me\.golemcore\.bot\.domain\.model\..*" />
                <Class name="~me\.golemcore\.bot\.port\..*" />
            </Or>
        </Not>
    </Match>
    <!--
        Broad catch(Exception) is intentional in pipeline systems to prevent
        one system's failure from crashing the entire agent loop.
    -->
    <Match>
        <Bug pattern="REC_CATCH_EXCEPTION" />
        <Class name="~me\.golemcore\.bot\.domain\.system\..*" />
    </Match>
    <!--
        Returning null from getObject() is intentional â€” null means "file not found".
        Callers (getText, etc.) depend on this null semantic to distinguish
        missing files from empty files.
    -->
    <Match>
        <Bug pattern="PZLA_PREFER_ZERO_LENGTH_ARRAYS" />
        <Class name="me.golemcore.bot.adapter.outbound.storage.LocalStorageAdapter" />
    </Match>
    <!--
        Response.body() null checks are defensive.
        While OkHttp 5.x marks body() as non-null, it can still return null
        for empty responses (204 No Content, etc.). Keep defensive checks.
    -->
    <Match>
        <Bug pattern="RCN_REDUNDANT_NULLCHECK_OF_NONNULL_VALUE" />
        <Class name="me.golemcore.bot.adapter.outbound.voice.ElevenLabsAdapter" />
    </Match>
</FindBugsFilter>
